<!DOCTYPE html>
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
        <!-- <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">     -->
        <link rel="stylesheet" href="./style.css">
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="http://hongru.github.io/proj/canvas2image/canvas2image.js"></script>
</head>
    <body>
        <div class="col-11 ml-2 d-flex flex-row justify-content-between m-3">
            <h6>Welcome, <%= name %></h6>
            <div class="d-flex flex-row justify-content-center align-items-center">
                <form action="/logout" method="get">
                  <button class="btn" type="submit">Log Out</button>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                    <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                </svg>
                </form>
            </div>
        </div> 
        <h5 class="text-center">Choose from candidates</h5>
        <hr class="text-center m-auto my-3" width="300px"/>
       

        <div class="col-10 m-auto d-flex flex-row flex-wrap">

          <div class="col-4 my-3">
            <div  class="card mx-5" > 
              <img src="./Nikhil.jpeg" class="card-img-top" alt="...">
              <div class="card-body">
                <div class="d-flex flex-row justify-content-center align-items-center">
                      <div class="col-10">
                          <h5>Nikhil Kumar</h5>
                          <p>Long Live ISM</p>
                      </div>
                      <a class="bg-danger mail">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                          </a>
                      
                </div>
                <form action="/manifesto" method="post">
                <button type="submit" name="candidateManifesto" value="Nikhil" class="col-12 btn btn-outline-danger my-3">Manifesto</button>
                </form>
                <button type="button" class="col-12 btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal1">
                  Vote
                </button>
                
                <!-- Modal -->
                <div class="modal fade bd-example-modal-lg" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog ">
                    <div class="modal-content">
                      
                      <div class="modal-body text-center">
                        <h5><strong>Confirm Vote to Nikhil Kumar?</strong></h5>
                        <div class="d-flex flex-column justify-content-around">
                      
                          <video id="video0"class="m-auto" width="320" height="240" autoplay></video>
                          <button class="btn btn-primary" id="start-camera0" onclick="camerastart('0')">Start Camera</button>
                     
                      
                      
                         <canvas id="canvas0" width="320" height="240" class="m-auto m-1" style='display:none;object-fit: contain;'></canvas>
                         <button class="btn btn-primary m-1" id="click-photo0" onclick="clickphoto('0')" style='display:none;'>Click Photo</button>
                         <button class="btn btn-secondary m-1" id="retake0" onclick="retake('0')" style='display:none;'>Retake</button>
                       </div>
                        <p>You won't be able to change vote once voted.</p>
                      </div>
                      <form action="/voted" method="post">
                      <div class="modal-footer d-flex flex-row justify-content-around">
                        
                        
                        <button type="button" class="col-5 btn btn-outline-secondary" data-bs-dismiss="modal" onclick="retake('0')">cancel</button>
                        <button type="submit" id="vote0" disabled class="col-5 btn btn-primary" data-bs-dismiss="modal"   name="candidate" value="Nikhil"   >Confirm Vote</button>
                        
                      </div>
                    </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-4 my-3">
            <div  class="card mx-5" > 
              <img src="./Krishan.jpeg" class="card-img-top" alt="...">
              <div class="card-body">
                <div class="d-flex flex-row justify-content-center align-items-center">
                      <div class="col-10">
                          <h5>Krishan kant mehra</h5>
                          <p>Vote For Better Tommorow</p>
                      </div>
                      <a class="bg-danger mail">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                          </a>
                      
                </div>
                <form action="/manifesto" method="post">
                <button type="submit" name="candidateManifesto" value="Krishan" class="col-12 btn btn-outline-danger my-3">Manifesto</button>
                </form>

                <button type="button" class="col-12 btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal2">
                  Vote
                </button>
                
                <!-- Modal -->
                <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-body text-center">
                        <h5><strong>Confirm Vote to Krishan Kant Mehra?</strong></h5>
                        <div class="d-flex flex-column justify-content-around">
                      
                          <video id="video1"class="m-auto" width="320" height="240" autoplay></video>
                          <button class="btn btn-primary" id="start-camera1" onclick="camerastart('1')">Start Camera</button>
                     
                      
                      
                         <canvas id="canvas1" width="320" height="240" class="m-auto m-1" style='display:none;object-fit: contain;'></canvas>
                         <button class="btn btn-primary m-1" id="click-photo1" onclick="clickphoto('1')" style='display:none;'>Click Photo</button>
                         <button class="btn btn-secondary m-1" id="retake1" onclick="retake('1')" style='display:none;'>Retake</button>
                       </div>
                        <p>You won't be able to change vote once voted.</p>
                      </div>
                      <form action="/voted" method="post">
                      <div class="modal-footer d-flex flex-row justify-content-around">
                        
                        <button type="button" class="col-5 btn btn-outline-secondary" data-bs-dismiss="modal" onclick="retake('1')">cancel</button>
                        <button type="submit" id="vote1" disabled class="col-5 btn btn-primary" data-bs-dismiss="modal"    name="candidate" value="Krishan"   >Confirm Vote</button>
                        
                      </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-4 my-3">
            <div  class="card mx-5" > 
              <img src="./Om.jpeg" class="card-img-top" alt="...">
              <div class="card-body">
                <div class="d-flex flex-row justify-content-center align-items-center">
                      <div class="col-10">
                          <h5>Om Kumar</h5>
                          <p>A vote for me is a vote for you.</p>
                      </div>
                      <a class="bg-danger mail">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                          </a>
                      
                </div>
                <form action="/manifesto" method="post">
                <button type="submit" name="candidateManifesto" value="Om" class="col-12 btn btn-outline-danger my-3">Manifesto</button>
                </form>
                <button type="button" class="col-12 btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal3">
                  Vote
                </button>
                
                <!-- Modal -->
                <div class="modal fade" id="exampleModal3" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-body text-center">
                        <h5><strong>Confirm Vote to Om Kumar?</strong></h5>
                        <div class="d-flex flex-column justify-content-around">
                      
                          <video id="video2"class="m-auto" width="320" height="240" autoplay></video>
                          <button class="btn btn-primary" id="start-camera2" onclick="camerastart('2')">Start Camera</button>
                     
                      
                      
                         <canvas id="canvas2" width="320" height="240" class="m-auto m-1" style='display:none;object-fit: contain;'></canvas>
                         <button class="btn btn-primary m-1" id="click-photo2" onclick="clickphoto('2')" style='display:none;'>Click Photo</button>
                         <button class="btn btn-secondary m-1" id="retake2" onclick="retake('2')" style='display:none;'>Retake</button>
                       </div>
                        <p>You won't be able to change vote once voted.</p>
                      </div>
                      <form action="/voted" method="post">
                      <div class="modal-footer d-flex flex-row justify-content-around">
                        
                        <button type="button" class="col-5 btn btn-outline-secondary" data-bs-dismiss="modal" onclick="retake('2')">cancel</button>
                        <button type="submit" id="vote2" disabled class="col-5 btn btn-primary" data-bs-dismiss="modal" name="candidate" value="Om"  >Confirm Vote</button>
                        
                      </div>
                    </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-4 my-3">
            <div  class="card mx-5" > 
              <img src="./Rachit.jpeg" class="card-img-top" alt="...">
              <div class="card-body">
                <div class="d-flex flex-row justify-content-center align-items-center">
                      <div class="col-10">
                          <h5>Rachit Abrol</h5>
                          <p>Keep Calm and Vote Rachit</p>
                      </div>
                      <a class="bg-danger mail">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                          </a>
                      
                </div>
                
                <form action="/manifesto" method="post">  
                <button type="submit" name="candidateManifesto" value="Rachit" class="col-12 btn btn-outline-danger my-3">Manifesto</button>
                </form>
                <button type="button" class="col-12 btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal4">
                  Vote
                </button>
                <!-- Modal -->
                <div class="modal fade" id="exampleModal4" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-body text-center">
                        <h5><strong>Confirm Vote to Rachit Abrol?</strong></h5>
                        <div class="d-flex flex-column justify-content-around">
                      
                          <video id="video3"class="m-auto" width="320" height="240" autoplay></video>
                          <button class="btn btn-primary" id="start-camera3" onclick="camerastart('3')">Start Camera</button>
                     
                      
                      
                         <canvas id="canvas3" width="320" height="240" class="m-auto m-1" style='display:none;object-fit: contain;'></canvas>
                         <button class="btn btn-primary m-1" id="click-photo3" onclick="clickphoto('3')" style='display:none;'>Click Photo</button>
                         <button class="btn btn-secondary m-1" id="retake3" onclick="retake('3')" style='display:none;'>Retake</button>
                       </div>
                        <p>You won't be able to change vote once voted.</p>
                      </div>
                      <form action="/voted" method="post">
                      <div class="modal-footer d-flex flex-row justify-content-around">
                        
                        <button type="button" class="col-5 btn btn-outline-secondary" data-bs-dismiss="modal" onclick="retake('3')">cancel</button>
                        <button type="submit" id="vote3" disabled class="col-5 btn btn-primary" data-bs-dismiss="modal"   name="candidate" value="Rachit"   >Confirm Vote</button>
                        
                      </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-4 my-3">
            <div  class="card mx-5" > 
              <img src="./Saumik.jpeg" class="card-img-top" alt="...">
              <div class="card-body">
                <div class="d-flex flex-row justify-content-center align-items-center">
                      <div class="col-10">
                          <h5>Kumar Saumik</h5>
                          <p>Jai Maa Kali ISM Bhaukali</p>
                      </div>
                      <a class="bg-danger mail">
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="16" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
                              <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                          </a>
                      
                </div>
                <form action="/manifesto" method="post">
                <button type="submit" name="candidateManifesto" value="Saumik" class="col-12 btn btn-outline-danger my-3">Manifesto</button>
                </form>
                <button type="button" class="col-12 btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal5">
                  Vote
                </button>
                
                <!-- Modal -->
                <div class="modal fade" id="exampleModal5" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-body text-center">
                        <h5><strong>Confirm Vote to Kumar Saumik?</strong></h5>
                        <div class="d-flex flex-column justify-content-around">
                      
                          <video id="video4"class="m-auto" width="320" height="240" autoplay></video>
                          <button class="btn btn-primary" id="start-camera4" onclick="camerastart('4')">Start Camera</button>
                     
                      
                      
                         <canvas id="canvas4" width="320" height="240" class="m-auto m-1" style='display:none;object-fit: contain;'></canvas>
                         <button class="btn btn-primary m-1" id="click-photo4" onclick="clickphoto('4')" style='display:none;'>Click Photo</button>
                         <button class="btn btn-secondary m-1" id="retake4" onclick="retake('4')" style='display:none;'>Retake</button>
                       </div>
                        <p>You won't be able to change vote once voted.</p>
                      </div>
                      <form action="/voted" method="post" >
                      <div class="modal-footer d-flex flex-row justify-content-around">
                        
                        <button type="button" class="col-5 btn btn-outline-secondary" data-bs-dismiss="modal" onclick="retake('4')">cancel</button>
                        <button type="submit" id="vote4" disabledclass="col-5 btn btn-primary" data-bs-dismiss="modal"   name="candidate" value="Saumik"   >Confirm Vote</button>
                        
                      </div>
                    </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>    

      </div>
      <script>
        async function camerastart(id){
          document.getElementById('start-camera' + id).style.display = 'none'
          document.getElementById('click-photo' + id).style.display = "block"
          
          let stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
	        document.getElementById('video' + id).srcObject = stream;
        }
        async function clickphoto(id){
         let canvas=document.getElementById('canvas' + id);
          canvas.style.display = "block"
          document.getElementById('vote'+id).disabled=false;
          let video = document.getElementById('video' + id)
          document.getElementById('retake' + id).style.display = "block"
          document.getElementById('click-photo' + id).style.display = "none"
          canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
          document.getElementById('video' + id).style.display = "none"
          var image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");  
          window.location.href=image;
        }
        retake =(id)=>{
          document.getElementById('click-photo' + id).style.display = "block"
          document.getElementById('retake' + id).style.display = "none"
          document.getElementById('canvas' + id).style.display = "none"
          document.getElementById('video' + id).style.display = "block"
        }
      </script>
      
        <% if( triggerModal==='0' ){ %>
        <% }else if( triggerModal==='1' ){ %>
        <script>
          swal("Oops!","You can vote only once.","error")
        </script>
        <% }else { %>
          <script>
            swal("Congratulations!","Your vote has been saved.","success")
          </script>
      <%}%>
    </body>
</html>